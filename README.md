# OS_study
OS study with XV6

## xv6 주요 파일 설명
- **user.h** : xv6의 시스템 콜 정의하는 헤더 파일
- **usys.S** : xv6의 시스템 콜 리스트
- **defs.h** : 데이터 타입, 매크로, 상수, 함수 정의를 갖는 헤더 파일
- **syscall.h** : 시스템 콜 번호를 매핑하는 헤ㄷㄱ더 파일. 새로운 시스템 콜을 추가하려면 번호를 추가해야 함
- **syscall.c** : 시스템 콜 인수를 구문 분석하는 함수 및 실제 시스템 콜 구현에 대한 포인터
- **sysproc.c** : 프로세스 관련 시스템 호출 구현. `fork()`, `exec()`, `wait()`, `exit()` 와 같은 시스템 호출의 실제 로직이 있음. 새로운 프로세스 관련 시스템 호출을 추가할 때 여기에 코드를 작성해야 함
- **proc.h** : 프로세스에 대한 구조체인 `struct proc`의 정의가 포함된 헤더 파일. 프로세스의 상태, PID(프로세스 ID), 부모 프로세스, 스택 포인터 등 프로세스에 대한 추가 정보를 추적하는 데 사용됨
- **proc.c** : 프로세스 간의 스케줄링 및 컨텍스트 전환을 수행하는 함수가 구현된 파일.

## 시스템 콜을 추가하는 전체적인 과정
1. **전역 변수 선언**: `sysproc.c` 혹은`proc.c`에 전역 변수를 선언
2. **시스템 콜 함수 구현**: 시스템 콜에 대한 동작을 정의하는 함수를 `sysproc.c`에 작성
3. **시스템 콜 번호 할당**: `syscall.h`에 새로운 시스템 콜 번호를 할당
4. **시스템 콜 테이블 등록**: `syscall.c` 파일에 시스템 콜 테이블에 새로운 시스템 콜을 등록
5. **유저 인터페이스 추가**: `usys.S` 파일에 시스템 콜을 유저 공간에서 호출할 수 있도록 선언
6. **유저 프로그램 추가** : `user.h` 파일에 유저 공간에서 사용할 함수의 선언부 작성



### 현재 살아있는 프로세스의 실행 상태를 알려주는 시스템 콜 ps
사용법 : ps
결과 설명 : 프로세스의 이름(역할)과 프로세스 아이디, 프로세스 상태를 띄워줌


### fork 시스템 콜 발생 횟수를 세주는 시스템 콜 getforkcount
사용법 : getforkcount
결과 설명 : getforkcount 호출 시점을 기준으로 fork가 발생한 횟수를 알려줌.
          시스템 콜 내부에서 fork 호출 후, 다시 횟수를 알려줌

### 시스템 콜이 발생할 때마다 시스템 콜 종류와 프로세스 정보를 출력해주는 시스템 콜 trace
사용법 :  trace 1 -> 기능 on  / trace 0 -> 기능 off
결과 설명 : 프로세스 이름, 프로세스 아이디, 시스템 콜 넘버를 알려줌. write 시스템콜의 경우 write한 글자가 옆에 같이 뜸
